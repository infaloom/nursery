"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[3624],{6841:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>c,metadata:()=>a,toc:()=>t});const a=JSON.parse('{"id":"keycloak/keycloak","title":"Keycloak","description":"Keycloak is an open-source identity and access management solution aimed at modern applications and services. It provides features such as single sign-on (SSO), user federation, identity brokering, and social login. Keycloak supports standard protocols like OAuth2, OpenID Connect, and SAML 2.0, making it a versatile choice for managing authentication and authorization in various environments.","source":"@site/docs/105-keycloak/10-keycloak.md","sourceDirName":"105-keycloak","slug":"/keycloak/keycloak","permalink":"/nursery/keycloak/keycloak","draft":false,"unlisted":false,"editUrl":"https://github.com/infaloom/nursery/tree/main/docusaurus/docs/105-keycloak/10-keycloak.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{},"sidebar":"defaultSidebar","previous":{"title":"Redis","permalink":"/nursery/redis/"},"next":{"title":"OpenBao UI SSO","permalink":"/nursery/keycloak/openbao-ui-sso"}}');var o=s(4848),i=s(8453);const c={},r="Keycloak",l={},t=[{value:"Deploy Keycloak",id:"deploy-keycloak",level:2},{value:"Access Keycloak",id:"access-keycloak",level:2},{value:"Create Realm, Clients, and Users",id:"create-realm-clients-and-users",level:2},{value:"Create Groups",id:"create-groups",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"keycloak",children:"Keycloak"})}),"\n",(0,o.jsx)(n.p,{children:"Keycloak is an open-source identity and access management solution aimed at modern applications and services. It provides features such as single sign-on (SSO), user federation, identity brokering, and social login. Keycloak supports standard protocols like OAuth2, OpenID Connect, and SAML 2.0, making it a versatile choice for managing authentication and authorization in various environments."}),"\n",(0,o.jsx)(n.h2,{id:"deploy-keycloak",children:"Deploy Keycloak"}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsx)(n.p,{children:"Database setup is complete as part of the Cloud Native PostgreSQL deployment."})}),"\n",(0,o.jsx)(n.p,{children:"You can now deploy Keycloak using the provided Kubernetes manifests."}),"\n",(0,o.jsx)(n.p,{children:"Apply Keycloak namespace:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f k8s/keycloak/keycloak-namespace.yaml\n"})}),"\n",(0,o.jsx)(n.p,{children:"Apply config secret for Keycloak:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"envsubst < k8s/keycloak/keycloak-config-external-secret.yaml | kubectl apply -f -\n"})}),"\n",(0,o.jsx)(n.p,{children:"Apply Keycloak deployment:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f k8s/keycloak/keycloak.yaml\n"})}),"\n",(0,o.jsx)(n.p,{children:"Apply Keycloak ingress:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"envsubst < k8s/keycloak/keycloak-ingress.yaml | kubectl apply -f -\n"})}),"\n",(0,o.jsx)(n.p,{children:"Apply Keycloak admin ingress:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"envsubst < k8s/keycloak/keycloak-admin-ingress.yaml | kubectl apply -f -\n"})}),"\n",(0,o.jsx)(n.h2,{id:"access-keycloak",children:"Access Keycloak"}),"\n",(0,o.jsxs)(n.p,{children:["You can access the Keycloak user account console at: ",(0,o.jsx)(n.code,{children:"https://account.${CLUSTER_DOMAIN}"})]}),"\n",(0,o.jsxs)(n.p,{children:["You can access the Keycloak admin console at: ",(0,o.jsx)(n.code,{children:"https://keycloak.${CLUSTER_DOMAIN}"})]}),"\n",(0,o.jsxs)(n.p,{children:["The default admin username is ",(0,o.jsx)(n.code,{children:"admin"})," and the password is ",(0,o.jsx)(n.code,{children:"admin"}),". Create a proper admin user immediately after your first login and delete the default admin user to ensure the security of your Keycloak instance."]}),"\n",(0,o.jsx)(n.h2,{id:"create-realm-clients-and-users",children:"Create Realm, Clients, and Users"}),"\n",(0,o.jsxs)(n.p,{children:["You need to create a new realm called ",(0,o.jsx)(n.code,{children:"nursery"}),", users and clients as needed for your applications. The detailed config is beyond the scope of this documentation, but you can refer to the ",(0,o.jsx)(n.a,{href:"https://www.keycloak.org/documentation",children:"Keycloak Documentation"})," for guidance on how to set up realms, clients, and users according to your requirements."]}),"\n",(0,o.jsx)(n.h2,{id:"create-groups",children:"Create Groups"}),"\n",(0,o.jsx)(n.p,{children:"You can create groups in Keycloak to manage user permissions and access control more efficiently. You should create a the following groups at minimum:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Forgejo Contributors"})," group for users who should have access to Forgejo"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Forgejo Admins"})," group for users who should have administrative privileges in Forgejo"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Admins"})," group for users who should have administrative privileges in cluster-wide applications"]}),"\n"]}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsxs)(n.p,{children:["Add ",(0,o.jsx)(n.code,{children:"groups"})," scope to the clients that you will be using for SSO, otherwise group information will not be included in the tokens issued by Keycloak and SSO configuration will not work as expected."]})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>r});var a=s(6540);const o={},i=a.createContext(o);function c(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);