"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[9374],{5780:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"ingress-and-ssl/letsencrypt","title":"Let\'s Encrypt","description":"Environment variables","source":"@site/docs/50-ingress-and-ssl/20-letsencrypt.md","sourceDirName":"50-ingress-and-ssl","slug":"/ingress-and-ssl/letsencrypt","permalink":"/nursery/ingress-and-ssl/letsencrypt","draft":false,"unlisted":false,"editUrl":"https://github.com/infaloom/nursery/tree/main/docusaurus/docs/50-ingress-and-ssl/20-letsencrypt.md","tags":[],"version":"current","sidebarPosition":20,"frontMatter":{},"sidebar":"defaultSidebar","previous":{"title":"Load balancer DNS","permalink":"/nursery/ingress-and-ssl/load-balancer-dns"},"next":{"title":"Traefik & Core DNS","permalink":"/nursery/ingress-and-ssl/traefik"}}');var r=s(4848),a=s(8453);const i={},l="Let's Encrypt",c={},o=[{value:"Environment variables",id:"environment-variables",level:2},{value:"Install cert-manager",id:"install-cert-manager",level:2},{value:"Install letsencrypt issuer",id:"install-letsencrypt-issuer",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"lets-encrypt",children:"Let's Encrypt"})}),"\n",(0,r.jsx)(n.h2,{id:"environment-variables",children:"Environment variables"}),"\n",(0,r.jsx)(n.p,{children:"Set the email address for Let's Encrypt:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pulumi --cwd $PULUMI_CWD config set --secret letsencrypt:email {REPLACE_WITH_YOUR_EMAIL_ADDRESS}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Export the envrionment variables:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"export LETSENCRYPT_EMAIL=$(pulumi --cwd $PULUMI_CWD config get letsencrypt:email); \\\nexport SSH_SOURCE_IP=$(pulumi --cwd $PULUMI_CWD config get ssh:sourceIp); \\\nexport CLUSTER_DOMAIN=$(pulumi --cwd $PULUMI_CWD config get cluster:domain)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"install-cert-manager",children:"Install cert-manager"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.17.0/cert-manager.yaml\n"})}),"\n",(0,r.jsx)(n.p,{children:"Wait for cert-manager to be ready."}),"\n",(0,r.jsx)(n.h2,{id:"install-letsencrypt-issuer",children:"Install letsencrypt issuer"}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["This is a production setup. Make sure you understand the implications of using letsencrypt in production.\nDefine proper email address in the env variable as explained above.\nIf you want to experiment use ",(0,r.jsx)(n.a,{href:"https://letsencrypt.org/docs/staging-environment/",children:"https://letsencrypt.org/docs/staging-environment/"}),".\nSet the appropriate letsencrypt environment in the ",(0,r.jsx)(n.code,{children:"k8s/kube-system/letsencrypt-production.yaml"})," file."]})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"envsubst < k8s/kube-system/letsencrypt-production.yaml | kubectl apply -f -\n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>l});var t=s(6540);const r={},a=t.createContext(r);function i(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);